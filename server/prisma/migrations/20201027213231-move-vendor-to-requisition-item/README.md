# Migration `20201027213231-move-vendor-to-requisition-item`

This migration has been generated by Ayush Goyal at 10/27/2020, 5:32:31 PM.
You can check out the [state of the schema](./schema.prisma) after the migration.

## Database Steps

```sql
ALTER TABLE "public"."Requisition" DROP CONSTRAINT "Requisition_vendorId_fkey"

ALTER TABLE "public"."Requisition" DROP COLUMN "vendorId"

ALTER TABLE "public"."RequisitionItem" ADD COLUMN "vendorId" integer   

ALTER TABLE "public"."RequisitionItem" ADD FOREIGN KEY ("vendorId")REFERENCES "public"."Vendor"("id") ON DELETE SET NULL ON UPDATE CASCADE
```

## Changes

```diff
diff --git schema.prisma schema.prisma
migration 20201027212827-make-fields-optional..20201027213231-move-vendor-to-requisition-item
--- datamodel.dml
+++ datamodel.dml
@@ -3,9 +3,9 @@
 }
 datasource db {
   provider = "postgresql"
-  url = "***"
+  url = "***"
 }
 enum AccessLevel {
   NONE
@@ -140,9 +140,8 @@
   headline             String?
   description          String?
   status               RequisitionStatus @default(DRAFT)
   projectId            Int
-  vendorId             Int?
   projectRequisitionId Int
   createdById          Int
   paymentRequiredBy    String?
   otherFees            Float?
@@ -155,9 +154,8 @@
   budget               Budget?           @relation(fields: [budgetId], references: [id])
   createdBy            User              @relation(fields: [createdById], references: [id])
   fundingSource        PaymentMethod?    @relation(fields: [fundingSourceId], references: [id])
   project              Project           @relation(fields: [projectId], references: [id])
-  vendor               Vendor?           @relation(fields: [vendorId], references: [id])
   approvals            Approval[]
   files                File[]
   payments             Payment[]
   items                RequisitionItem[]
@@ -172,17 +170,19 @@
   link          String?
   notes         String?
   received      Boolean?
   lineItemId    Int?
+  vendorId      Int?
   lineItem      LineItem?   @relation(fields: [lineItemId], references: [id])
   requisition   Requisition @relation(fields: [requisitionId], references: [id])
+  vendor        Vendor?     @relation(fields: [vendorId], references: [id])
 }
 model Vendor {
-  id           Int           @id @default(autoincrement())
-  name         String        @unique
-  isActive     Boolean       @default(true)
-  requisitions Requisition[]
+  id               Int               @id @default(autoincrement())
+  name             String            @unique
+  isActive         Boolean           @default(true)
+  requisitionItems RequisitionItem[]
 }
 model User {
   id           Int           @id @default(autoincrement())
```


